(function(e){function r(r){for(var s,o,i=r[0],l=r[1],u=r[2],d=0,m=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&m.push(a[o][0]),a[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);c&&c(r);while(m.length)m.shift()();return n.push.apply(n,u||[]),t()}function t(){for(var e,r=0;r<n.length;r++){for(var t=n[r],s=!0,i=1;i<t.length;i++){var l=t[i];0!==a[l]&&(s=!1)}s&&(n.splice(r--,1),e=o(o.s=t[0]))}return e}var s={},a={app:0},n=[];function o(r){if(s[r])return s[r].exports;var t=s[r]={i:r,l:!1,exports:{}};return e[r].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=e,o.c=s,o.d=function(e,r,t){o.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,r){if(1&r&&(e=o(e)),8&r)return e;if(4&r&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var s in e)o.d(t,s,function(r){return e[r]}.bind(null,s));return t},o.n=function(e){var r=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(r,"a",r),r},o.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=r,i=i.slice();for(var u=0;u<i.length;u++)r(i[u]);var c=l;n.push([0,"chunk-vendors"]),t()})({0:function(e,r,t){e.exports=t("56d7")},1:function(e,r){},10:function(e,r){},11:function(e,r){},12:function(e,r){},13:function(e,r){},14:function(e,r){},15:function(e,r){},2:function(e,r){},"25d8":function(e,r,t){},3:function(e,r){},4:function(e,r){},5:function(e,r){},"56d7":function(e,r,t){"use strict";t.r(r);t("cadf"),t("551c"),t("f751"),t("097d");var s=t("2b0e"),a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},n=[],o=t("2877"),i={},l=Object(o["a"])(i,a,n,!1,null,null,null),u=l.exports,c=t("8c4f"),d=function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("section",[s("h1",[e._v("Signup")]),e.signingUp?s("div",[s("img",{attrs:{src:t("5c3d")}})]):e._e(),e.errorMessage?s("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v(e._s(e.errorMessage))]):e._e(),s("div",{staticClass:"container"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg=3 col-md-2 col-sm-1 col-xs-12"}),s("div",{staticClass:"col-lg=6 col-md-8 col-sm-10 col-xs-12"},[e.signingUp?e._e():s("form",{on:{submit:function(r){return r.preventDefault(),e.signup(r)}}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"name"}},[e._v("Name")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.name,expression:"user.name"}],staticClass:"form-control",attrs:{type:"text",id:"name","aria-describedby":"nameHelp",required:""},domProps:{value:e.user.name},on:{input:function(r){r.target.composing||e.$set(e.user,"name",r.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"email"}},[e._v("Email")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"}],staticClass:"form-control",attrs:{type:"text",id:"email","aria-describedby":"emailHelp",required:""},domProps:{value:e.user.email},on:{input:function(r){r.target.composing||e.$set(e.user,"email",r.target.value)}}})]),s("div",{staticClass:"form-row"},[s("div",{staticClass:"form-group col-md-6"},[s("label",{attrs:{for:"password"}},[e._v("Password")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],staticClass:"form-control",attrs:{type:"password",id:"password","aria-describedby":"passwordHelp",required:""},domProps:{value:e.user.password},on:{input:function(r){r.target.composing||e.$set(e.user,"password",r.target.value)}}})]),s("div",{staticClass:"form-group col-md-6"},[s("label",{attrs:{for:"confirmPassword"}},[e._v("Confirm Password")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.confirmPassword,expression:"user.confirmPassword"}],staticClass:"form-control",attrs:{type:"password",id:"confirmPassword","aria-describedby":"confirmPasswordHelp",required:""},domProps:{value:e.user.confirmPassword},on:{input:function(r){r.target.composing||e.$set(e.user,"confirmPassword",r.target.value)}}})])]),s("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v("Signup")])]),s("div",{staticClass:"mt-3"},[s("router-link",{attrs:{to:"/signin"}},[e._v("I am already a member")])],1)])]),s("div",{staticClass:"col-lg=3 col-md-2 col-sm-1 col-xs-12"})])])},m=[],p=(t("6762"),t("2fdb"),t("ac6a"),t("7f7f"),t("f0b1")),f=t.n(p),g=t("5fb0"),v=g.API_URL,h=v+"/signup",b={data:function(){return{signingUp:!1,errorMessage:"",user:{email:"",password:"",confirmPassword:"",name:""}}},watch:{user:{handler:function(){this.errorMessage=""},deep:!0}},methods:{signup:function(){var e=this;if(this.errorMessage="",this.validUser()){var r={email:this.user.email,password:this.user.password,name:this.user.name};this.signingUp=!0,fetch(h,{method:"POST",body:JSON.stringify(r),headers:{"content-type":"application/json"}}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw new Error(e.error)}))})).then((function(r){localStorage.token=r.token,e.signingUp=!1,e.$router.push("/dashboard")})).catch((function(r){e.signingUp=!1,e.errorMessage=r.message}))}},validUser:function(){var e=f.a.object().keys({email:f.a.string().email().required(),password:f.a.string().regex(/^[a-zA-Z0-9]{5,30}$/).required(),confirmPassword:f.a.string().regex(/^[a-zA-Z0-9]{5,30}$/).required(),name:f.a.string().min(3).max(30).required()});if(this.user.password!==this.user.confirmPassword)return this.errorMessage="Passwords must match.",!1;var r=f.a.validate(this.user,e);return null===r.error||(r.error.message.includes("name")?(this.errorMessage="bad length or format of a name",!1):(r.error.message.includes("email")?this.errorMessage="email is invalid.":this.errorMessage="Password is invalid.",!1))}}},w=b,_=Object(o["a"])(w,d,m,!1,null,null,null),y=_.exports,P=function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("section",[s("h1",[e._v("Sign in with")]),e.loggingIn?s("div",[s("img",{attrs:{src:t("5c3d")}})]):e._e(),e.errorMessage?s("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v("\n    "+e._s(e._f("filtermessage")(e.errorMessage))+"\n  ")]):e._e(),e.loggingIn?e._e():s("div",{staticClass:"container"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg=3 col-md-2 col-sm-1 col-xs-12"}),s("div",{staticClass:"col-lg=6 col-md-8 col-sm-10 col-xs-12"},[s("form",{staticClass:"mt-2",on:{submit:function(r){return r.preventDefault(),e.signin()}}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"email"}},[e._v("Email")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"}],staticClass:"form-control",attrs:{type:"text",id:"email","aria-describedby":"emailHelp",required:""},domProps:{value:e.user.email},on:{input:function(r){r.target.composing||e.$set(e.user,"email",r.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"password"}},[e._v("Password")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],staticClass:"form-control",attrs:{type:"password",id:"password","aria-describedby":"passwordHelp",required:""},domProps:{value:e.user.password},on:{input:function(r){r.target.composing||e.$set(e.user,"password",r.target.value)}}})]),s("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v("Signin")])]),s("br"),s("div",[e._v("\n          Donâ€™t have an account?\n          "),s("router-link",{attrs:{to:"/signup"}},[e._v("Sign up")])],1)]),s("div",{staticClass:"col-lg=3 col-md-2 col-sm-1 col-xs-12"})])])])},C=[],x=t("5fb0"),S=x.API_URL,j=S+"/signin",M=f.a.object().keys({email:f.a.string().email().required(),password:f.a.string().regex(/^[a-zA-Z0-9]{5,30}$/).required()}),I={data:function(){return{errorMessage:"",loggingIn:!1,user:{email:"",password:""}}},filters:{filtermessage:function(e){return e.includes("Unexpected token")?"email and password do not match.":e}},methods:{signin:function(){var e=this;if(this.errorMessage="",this.validUser()){this.loggingIn=!0;var r={email:this.user.email,password:this.user.password};fetch(j,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(r)}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw new Error(e.message)}))})).then((function(r){localStorage.token=r.token,localStorage.userId=r.userId,e.loggingIn=!1,e.$router.push("/".concat(r.userId,"/dashboard"))})).catch((function(r){e.loggingIn=!1,e.errorMessage=r.message}))}},validUser:function(){var e=f.a.validate(this.user,M);return null===e.error||(e.error.message.includes("email")?(this.errorMessage="email is invalid.",!1):(this.errorMessage="Password is invalid.",!1))}}},k=I,O=(t("7a9b"),Object(o["a"])(k,P,C,!1,null,null,null)),$=O.exports,U=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[e.errorMessage?t("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v("\n    "+e._s(e.errorMessage)+"\n  ")]):e._e(),t("h1",[e._v("Dashboard")]),t("h2",{staticClass:"my-3"},[e._v("Hello, "+e._s(this.name))]),t("button",{staticClass:"btn btn-primary",on:{click:function(r){return e.logout()}}},[e._v("Logout")])])},E=[],q=t("5fb0"),N=q.API_URL,A=N+"/secret",H={mounted:function(){var e=this;this.$route.params.error&&404===this.$route.params.error&&(this.errorMessage="Page Not Found"),fetch(A,{headers:{Authorization:"Bearer ".concat(localStorage.token),"content-type":"application/json"},cache:"no-store"}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw new Error(e.error)}))})).then((function(r){e.name=r.secret})).catch((function(r){e.logout()}))},data:function(){return{errorMessage:"",name:""}},methods:{logout:function(){localStorage.removeItem("token"),localStorage.removeItem("userId"),this.$router.push("/signin")}}},D=H,L=Object(o["a"])(D,U,E,!1,null,null,null),T=L.exports,z=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("Dashboard",[t("div",{staticClass:"alert alert-warning"},[e._v("Page Not found")])])},J=[],R={components:[T]},Z=R,B=Object(o["a"])(Z,z,J,!1,null,null,null);B.exports;function F(e,r,t){localStorage.token?t("/".concat(localStorage.userId,"/dashboard")):t()}function G(e,r,t){console.log(e),localStorage.token?e.params.userId&&e.params.userId!==localStorage.userId?t({name:"dashboard",params:{userId:localStorage.userId,error:404}}):t():t("/signin")}s["a"].use(c["a"]);var K=new c["a"]({mode:"history",routes:[{path:"/",redirect:"/signin"},{path:"/signup",name:"signup",component:y,beforeEnter:F},{path:"/signin",name:"signin",component:$,beforeEnter:F},{path:"/:userId/dashboard",name:"dashboard",component:T,beforeEnter:G},{path:"*",redirect:{name:"dashboard"}}]}),Q=t("2f62");s["a"].use(Q["a"]);var V=new Q["a"].Store({state:{},mutations:{},actions:{}});s["a"].config.productionTip=!1,new s["a"]({router:K,store:V,render:function(e){return e(u)}}).$mount("#app")},"5c3d":function(e,r,t){e.exports=t.p+"img/spinner.8509c197.svg"},"5fb0":function(e,r,t){"use strict";t.r(r),t.d(r,"API_URL",(function(){return s}));var s="http://localhost:3000/api/auth"},6:function(e,r){},7:function(e,r){},"7a9b":function(e,r,t){"use strict";var s=t("25d8"),a=t.n(s);a.a},8:function(e,r){},9:function(e,r){}});
//# sourceMappingURL=app.139026c7.js.map